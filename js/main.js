!function(e){"use strict";var a=Modernizr.csstransitions,r={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"}[Modernizr.prefixed("transition")],o=function(e,t){var n=function(e){if(a){if(e.target!=this)return;this.removeEventListener(r,n)}t&&"function"==typeof t&&t.call(this)};a?e.addEventListener(r,n):n()},c=document.querySelector(".pages-stack"),l=[].slice.call(c.children),s=l.length,d=0,u=document.querySelector("button.menu-button"),f=document.querySelector(".pages-nav"),t=[].slice.call(f.querySelectorAll(".link--page")),p=!1;function v(){for(var e=y(),t=0;t<s;++t){var n=l[t],a=e.indexOf(t);d!==t?(classie.add(n,"page--inactive"),-1!==a?(n.style.WebkitTransform="translate3d(0,100%,0)",n.style.transform="translate3d(0,100%,0)"):(n.style.WebkitTransform="translate3d(0,75%,-300px)",n.style.transform="translate3d(0,75%,-300px)")):classie.remove(n,"page--inactive"),n.style.zIndex=t<d?parseInt(d-t):parseInt(s+d-t),n.style.opacity=-1!==a?parseFloat(1-.1*a):0}}function n(){p?i():(!function(){classie.add(u,"menu-button-open"),classie.add(c,"pages-stack-open"),classie.add(f,"pages-nav-open");for(var e=y(),t=0,n=e.length;t<n;++t){var a=l[e[t]];a.style.WebkitTransform="translate3d(0, 75%, "+parseInt(-200-50*t)+"px)",a.style.transform="translate3d(0, 75%, "+parseInt(-200-50*t)+"px)"}}(),p=!0)}function i(){m()}function m(e){var t=e?document.getElementById(e):l[d],n=l.indexOf(t),a=y(n);t.style.WebkitTransform="translate3d(0, 0, 0)",t.style.transform="translate3d(0, 0, 0)",t.style.opacity=1;for(var r=0,s=a.length;r<s;++r){var i=l[a[r]];i.style.WebkitTransform="translate3d(0,100%,0)",i.style.transform="translate3d(0,100%,0)"}e&&(d=n),classie.remove(u,"menu-button-open"),classie.remove(f,"pages-nav-open"),o(t,function(){classie.remove(c,"pages-stack-open"),v(),p=!1})}function y(e){var t=d+1<s?d+1:0,n=d+2<s?d+2:1,a=[];return e!=d&&a.push(d),e!=t&&a.push(t),e!=n&&a.push(n),a}v(),u.addEventListener("click",n),t.forEach(function(e){var t=e.getAttribute("href").slice(1);e.addEventListener("click",function(e){e.preventDefault(),m(t)})}),l.forEach(function(e){var t=e.getAttribute("id");e.addEventListener("click",function(e){p&&(e.preventDefault(),m(t))})}),document.addEventListener("keydown",function(e){if(p){var t=e.keyCode||e.which;27===t&&i()}})}(window);